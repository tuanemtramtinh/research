## Project Overview

This repository is a research framework that is split into two main parts:

- **`src/`**: Core logic framework, **without** the _human-in-the-loop_ (HITL) implementation yet.
- **`server/`**: Backend server with a full _human-in-the-loop_ implementation.

Each part has slightly different ways to run and separate `.env` configuration (explained below).

---

## 1. Python Environment Setup

Requirements:

- Python 3.x (recommended 3.10+)
- `pip` installed

### 1.1. Create a virtual environment

From the `main/` directory, open a terminal (PowerShell / CMD) and run:

```bash
python -m venv .venv
```

Activate the virtual environment:

- **PowerShell (Windows)**:

```bash
.\.venv\Scripts\Activate.ps1
```

- **CMD (Windows)**:

```bash
.\.venv\Scripts\activate.bat
```

Every time you open a new terminal, activate the virtual environment again before running commands.

### 1.2. Install dependencies

After activating the virtual environment and while in the `main/` directory, install the required packages:

```bash
pip install -r requirements.txt
```

(If the project uses separate `requirements` files for `src` and `server`, adjust the path to the correct `requirements` file accordingly.)

---

## 2. Directory Structure

At a high level, the `main/` directory looks like this:

```text
main/
  ├─ src/         # Core logic framework, without HITL
  ├─ server/      # Backend with human-in-the-loop implementation
  ├─ inputs/      # Test inputs
  ├─ manual_diagram/  # Expert-drawn use case diagrams
  ├─ outputs_sca/     # Scenario Generation Agent outputs for tested inputs
  ├─ outputs_rpa/     # Requirement Parsing Agent outputs for tested inputs
  ├─ .env.example # Environment variable template for src
  └─ README.md
```

Details:

- **`src/`**
  - Contains the core framework logic structure (pipelines, core modules, etc.).
  - Currently **does not** include the human-in-the-loop implementation.
  - This part uses the `.env` file at the **root of `main/`**.

- **`server/`**
  - Contains the backend server (API / service) with a human-in-the-loop implementation.
  - Has its own `.env.example` file inside the `server/` directory.
  - This part uses a `.env` file placed **inside the `server/` folder**.

- **`inputs/`**
  - Contains the input artifacts used for testing the framework and agents.
  - These inputs are the source data that both the Scenario Generation Agent and the Requirement Parsing Agent operate on.

- **`manual_diagram/`**
  - Contains expert-drawn use case diagrams.
  - These diagrams serve as the human-created ground truth or reference when evaluating and comparing the agents’ outputs.

- **`outputs_sca/`**
  - Contains the outputs generated by the **Scenario Generation Agent (SCA)** based on the test inputs in `inputs/`.
  - Each file typically corresponds to one input and describes the generated scenarios/use cases.

- **`outputs_rpa/`**
  - Contains the outputs generated by the **Requirement Parsing Agent (RPA)** based on the same test inputs in `inputs/`.
  - Each file typically corresponds to one input and describes the parsed/structured requirements.

---

## 3. `.env` Configuration

### 3.1. Running the `src/` part

1. In the `main/` directory, create a new `.env` file:

```bash
cp .env.example .env
```

Or create it manually and copy the content from `.env.example`.

2. Open `.env` and fill in all required environment variables (API keys, paths, model parameters, etc.).

> **Note**: The `src/` part **requires** the `.env` file at the **root of `main/`** to run correctly.

### 3.2. Running the `server/` part

1. Move into the `server/` directory:

```bash
cd server
```

2. Create a `.env` file in `server/` based on the template:

```bash
cp .env.example .env
```

3. Edit the `.env` file inside `server/` with your desired configuration (port, DB connection, API keys, etc.).

> **Note**: The `.env` file inside `server/` is **independent** from the `.env` at the root of `main/`.

---

## 4. How to Run

### 4.1. Run the framework logic in `src/`

Assuming you are in the `main/` directory and the virtual environment is activated:

```bash
python -m src.<main_module_name>
```

Or follow the specific entry point inside `src/` (for example: `src/main.py`, `src/app.py`, etc.).

Make sure that:

- `.env` has been created at the root of `main/` from `.env.example`.
- All dependencies have been installed in the virtual environment.

### 4.2. Run the backend server (with HITL)

From the root `main/` directory:

```bash
cd server
```

Make sure that:

- The virtual environment (created in step 1) is activated.
- A `.env` file has been created in `server/` from `.env.example`.

Then start the server, for example (depending on the framework you use, adjust as needed):

```bash
fastapi dev main.py
```

See the code inside `server/` for more details if there is a dedicated entry point or documentation file.

---

## 5. Additional Notes

- Do **not** commit `.env` files (they should already be ignored via `.gitignore`).
- If you change the structure of `src/` or `server/`, please update this README so that other team members can easily set up and run the project.
